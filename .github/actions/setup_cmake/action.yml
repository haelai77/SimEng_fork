name: setup cmake
description: installs and caches cmake

inputs:
  OS:
    required: true

runs:
  using: 'composite'
  steps:
    
    - if: ${{ inputs.OS == 'ubuntu:20.04' }}
      name: install cmake via apt
      shell: bash
      run: |
        wget -O - https://apt.kitware.com/keys/kitware-archive-latest.asc 2>/dev/null | gpg --dearmor - | tee /etc/apt/trusted.gpg.d/kitware.gpg >/dev/null && \
        apt-add-repository 'deb https://apt.kitware.com/ubuntu/ focal main' && \
        apt update && apt install cmake -y
        apt upgrade -y

    - if: ${{ inputs.OS == 'ubuntu:18.04' || inputs.OS == 'debian:10'}}
      name: install cmake via apt
      shell: bash
      run: |
        wget -O - https://apt.kitware.com/keys/kitware-archive-latest.asc 2>/dev/null | gpg --dearmor - | tee /etc/apt/trusted.gpg.d/kitware.gpg >/dev/null && \
        apt-add-repository 'deb https://apt.kitware.com/ubuntu/ bionic main' && \
        apt update && apt install cmake -y
        apt upgrade -y

    - if: ${{ inputs.OS == 'debian:11' }}
      name: install cmaked via apt
      shell: bash
      run: |
        apt install -y cmake
        
    # - if: ${{ inputs.OS == 'debian:10' }}
    #   name: install cmake from source
    #   shell: bash
    #   run: |
    #     wget https://github.com/Kitware/CMake/releases/download/v3.30.1/cmake-3.30.1.tar.gz
    #     tar xf cmake-3.30.1.tar.gz
    #     cd cmake-3.30.1
    #     ./bootstrap
    #     make
    #     make install